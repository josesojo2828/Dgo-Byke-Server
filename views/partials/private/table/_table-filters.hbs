<div class="card bg-base-100 shadow-sm border border-gray-200 mb-6">
    <div class="card-body p-4">
        
        <form action="{{filters.action}}" method="GET" class="flex flex-col md:flex-row items-end gap-4 flex-wrap">

            {{#each filters.fields}}

                {{!-- =========================
                      CASO 1: INPUT BUSQUEDA
                      ========================= --}}
                {{#if (eq this.type 'search')}}
                    <div class="form-control {{#if this.width}}{{this.width}}{{else}}w-full md:w-auto{{/if}}">
                        {{#if this.label}}
                            <label class="label">
                                <span class="label-text font-medium">{{this.label}}</span>
                            </label>
                        {{/if}}
                        <div class="relative">
                            <input 
                                type="text" 
                                name="{{this.name}}" 
                                value="{{this.value}}" 
                                placeholder="{{this.placeholder}}" 
                                class="input input-bordered w-full pr-10" 
                            />
                            <button type="submit" class="absolute right-0 top-0 h-full px-3 text-gray-500 hover:text-primary">
                                <i class="bi bi-search"></i>
                            </button>
                        </div>
                    </div>
                {{/if}}

                {{!-- =========================
                      CASO 2: SELECT DROPDOWN
                      ========================= --}}
                {{#if (eq this.type 'select')}}
                    <div class="form-control {{#if this.width}}{{this.width}}{{else}}w-full md:w-48{{/if}}">
                        <label class="label py-1">
                            <span class="label-text font-medium">{{this.label}}</span>
                        </label>
                        
                        <select name="{{this.name}}" class="select select-bordered w-full" onchange="this.form.submit()">
                            <option value="">{{this.placeholder}}</option>
                            
                            {{#each this.options}}
                                {{!-- Usamos tu helper 'eq' existente --}}
                                <option value="{{this.value}}" {{#if (eq ../value this.value)}}selected{{/if}}>
                                    {{this.label}}
                                </option>
                            {{/each}}
                        </select>
                    </div>
                {{/if}}

                {{!-- =========================
                      CASO 3: FECHA
                      ========================= --}}
                {{#if (eq this.type 'date')}}
                    <div class="form-control {{this.width}}">
                        <label class="label py-1">
                            <span class="label-text font-medium">{{this.label}}</span>
                        </label>
                        <input 
                            type="date" 
                            name="{{this.name}}" 
                            value="{{this.value}}" 
                            class="input input-bordered w-full"
                            onchange="this.form.submit()"
                        />
                    </div>
                {{/if}}

            {{!-- Cierre del EACH principal --}}
            {{/each}}

            {{!-- =========================
                  BOTÃ“N DE LIMPIAR
                  ========================= --}}
            <div class="pb-1">
                <a href="{{filters.action}}" class="btn btn-square btn-outline btn-error tooltip" data-tip="Limpiar filtros">
                    <i class="bi bi-x-lg"></i>
                </a>
            </div>

        </form>
    </div>
</div>